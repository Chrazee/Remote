version: "3"

services:
    app:
      build:
        context: ../docker/build/app
        args:
          APACHE_UID: 1000
          APACHE_GID: 1000
      container_name: remote_app
      ports:
      - "62080:80"
      volumes:
      - ../app:/var/www/html/:z
      links:
      - db
      depends_on:
      - db
      networks:
      - remote
      restart: unless-stopped

    db:
      image: mysql:8.0
      container_name: remote_db
      ports: 
      - "62081:3306"
      command: --default-authentication-plugin=mysql_native_password
      environment:
        MYSQL_DATABASE: ${DB_DATABASE}
        MYSQL_USER: ${DB_USERNAME}
        MYSQL_PASSWORD: ${DB_PASSWORD}
        MYSQL_ROOT_PASSWORD: ${DB_PASSWORD}
      volumes:
      - ../database:/var/lib/mysql
      networks:
      - remote
      restart: unless-stopped

networks:
  remote:
    driver: bridge
